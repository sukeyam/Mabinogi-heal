
import streamlit as st
import pandas as pd

# í ê³„ìˆ˜ ì •ì˜
heal_coefficients = {
    "ë¼ì´í”„ ë§í¬": 0.011,
    "ë¼ì´í”„ ë§í¬ (ì„œì•½ ë£¬)": 0.0132,
    "íŒ¬í…€ í˜ì¸ (ì–µì•• ë£¬)": 0.015,
    "í”„ë¡œí…ì…˜ (ê°ìŒˆ ë£¬)": 0.015,
    "í”„ë¡œí…ì…˜-íšŒë³µëŸ‰ (ê´‘ë¥œ ë£¬)": 0.02,
    "í”„ë¡œí…ì…˜-ì§€ì† íšŒë³µëŸ‰ (ê´‘ë¥œ ë£¬)": 0.008,
    "ì„œë¨¼ ë£¨ë¯¸ë„ˆìŠ¤": 0.015,
    "ìœ™ ì˜¤ë¸Œ ì—”ì ¤": 0.02,
    "ë¬¼ê²°": 0.0176,
    "ê°ìŒˆ": 0.024,
    "ë£¨ë¯¸ë„ˆìŠ¤": 0.024,
    "ë¹›ë¬´ë¦¬": 0.032,
    "ì–µì••": 0.024,
    "ìƒëª…ì˜ ê³ ë™": 0.015
}

# ë£¬ ì˜µì…˜
runes = {
    "ë¬´ê¸° ë£¬ (ê³µê²©ë ¥)": {
        "ì˜í˜¼ ìˆ˜í™•ì(6ì„±)": 0.20,
        "ê²€ë¬´+(8ì„±)": 0.20,
        "ë§ˆì§€ë§‰ ìë¹„(8ì„±)": 0.20,
        "ì¢…ì–¸+(8ì„±)": 0.20
    },
    "ë°©ì–´êµ¬ ë£¬ (ê³µê²©ë ¥)": {
        "ë¶‰ì€ ë§¹ì•½(6ì„±)": 0.18,
        "ì´ˆê¸°+(6ì„±)": 0.20,
        "ì €ê²©+(6ì„±)": 0.15,
        "ë§ˆë‚˜ê²©ë¥˜(6ì„±)": 0.14,
        "ë°”ìœ„ê±°ì¸(6ì„±)": 0.20,
        "ë¹„ì—´í•œ ì¼ê²©(6ì„±)": 0.24,
        "ì—¬ëª…+(8ì„±)": 0.21,
        "ë°”ìœ„ ê°ì‹œì(8ì„±)": 0.22,
        "ì €ë¬´ëŠ” ë‹¬(8ì„±)": 0.20,
        "ë•…ìš¸ë¦¼(8ì„±)": 0.30,
        "ì¹¨ë¬µí•˜ëŠ” ì‚°(8ì„±)": 0.22,
        "í•„ì‚¬+(8ì„±)": 0.20,
        "íŒŒë©¸+(8ì„±)": 0.25,
        "ì„±ì—­+(8ì„±)": 0.17,
        "ì„¬ì„¸í•œ ì†ë†€ë¦¼(8ì„±)": 0.06,
        "ì••ë„ì ì¸ í˜(8ì„±)": 0.06,
        "ë¶•ê´´í•˜ëŠ” ë³„(8ì„±)": 0.10,
        "ì§€íœ˜ê´€(8ì„±)": 0.225,
        "ë‚˜ë¬´ ì‚¬ìŠ´(8ì„±)": 0.12,
        "ìˆ˜ì • ê½ƒì(8ì„±)": 0.12,
        "ì–´ë‘ìš´ ì§•ë„(8ì„±)": 0.18,
        "ë°”ìŠ¤ëŸ¬ì§€ëŠ” ë¹›(ì‹ í™”)": 0.275,
        "ì´ë¦„ ì—†ëŠ” í˜¼ëˆ(ì‹ í™”)": 0.40
    },
    "ì— ë¸”ëŸ¼ (ê³µê²©ë ¥)": {
        "êµ³ê±´í•¨+(6ì„±)": 0.10,
        "ì—¬ì‹ ì˜ ê¶ŒëŠ¥(6ì„±)": 0.13,
        "ì¸ë„í•˜ëŠ” ë¹›(8ì„±)": 0.20,
        "ëŒ€ë§ˆë²•ì‚¬(8ì„±)": 0.45,
        "í©ë‚ ë¦¬ëŠ” ê²€(8ì„±)": 0.35
    },
    "ë¬´ê¸° ë£¬ (íšŒë³µëŸ‰)": {
        "ì§‘í–‰ì(8ì„±)": 0.20
    },
    "ë°©ì–´êµ¬ ë£¬ (íšŒë³µëŸ‰)": {
    },
    "ë°©ì–´êµ¬ ë£¬ (ê³µê²©ë ¥ + íšŒë³µëŸ‰)": {
        "ì‹ ì„±í•œ ìˆ˜ì–‘(6ì„±)": (0.12, 0.12),
        "ì‹ ì„±í•œ ì¹™ë ¹(8ì„±)": (0.15, 0.09)
    }
}

st.title("ë§ˆë¹„ë…¸ê¸° ëª¨ë°”ì¼ ì‹œì¦Œ1 íëŸ‰ ê³„ì‚°ê¸°")

atk = st.number_input("ê¸°ë³¸ ë§ˆì„ ê³µê²©ë ¥", value=15681, step=1)
heal = st.number_input("íšŒë³µë ¥", value=2485, step=1)

st.markdown("### ğŸ”˜ ì¶”ê°€ ì˜µì…˜")
master_emblem = st.checkbox("ğŸ›¡ï¸ ë§ˆìŠ¤í„° ì— ë¸”ë ˜ ì°©ìš© (+15% ê³µê²©ë ¥)")

st.markdown("### ğŸ“¦ ë£¬ ì„ íƒ")
selected_atk_runes = []
selected_heal_runes = []
atk_buff = 0
heal_buff = 0

for category, options in runes.items():
    with st.expander(f"â–¶ {category}"):
        for label, value in options.items():
            if isinstance(value, tuple):  # ê³µê²©ë ¥ + íšŒë³µë ¥
                checked = st.checkbox(f"{label} (+{int(value[0]*100)}% ê³µê²©ë ¥, +{int(value[1]*100)}% íšŒë³µë ¥)", key=label)
                if checked:
                    atk_buff += value[0]
                    heal_buff += value[1]
            elif "ê³µê²©ë ¥" in category:
                checked = st.checkbox(f"{label} (+{int(value*100)}%)", key=label)
                if checked:
                    atk_buff += value
            elif "íšŒë³µëŸ‰" in category:
                checked = st.checkbox(f"{label} (+{int(value*100)}%)", key=label)
                if checked:
                    heal_buff += value

if master_emblem:
    atk_buff += 0.15

# ì‹¤ ê²Œì„ ê¸°ì¤€ ë³´ì • ê³„ìˆ˜ ì ìš©
total_atk = int(atk + atk * atk_buff * 0.73)
heal_rate = (1.1 + heal_buff) * (1 + heal / 8750)

# ê²°ê³¼ ê³„ì‚°
data = []
for skill, coef in heal_coefficients.items():
    base_heal = round(atk * coef * heal_rate)
    buffed_heal = round(total_atk * coef * heal_rate)
    data.append((skill, base_heal, buffed_heal))

df = pd.DataFrame(data, columns=["ìŠ¤í‚¬", "ê¸°ë³¸ íëŸ‰", "ë£¬ ì ìš© íëŸ‰"])

st.markdown("---")
st.markdown("ğŸ’¡ **íëŸ‰ ê³„ì‚° ê²°ê³¼ (30ë ˆë²¨ ê¸°ì¤€)**")
st.markdown(f"ğŸ”º **ë³´ì • ê³µê²©ë ¥ : <span style='color:red; font-size:20px'><b>{total_atk}</b></span>**", unsafe_allow_html=True)
st.dataframe(df, use_container_width=True)
